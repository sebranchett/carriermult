##################################################################################
# Example of Full Brillouin Zone calculation of MoTe2
# For calculating carrier multiplication properties using cmscript.py
# Full Brillouin Zone calculations are required. This means that instead of k-points
# in the irreducible Brillouin zone, k-points in the entire Brillouin zone will be
# used.
# For plotting band-structures in a band diagram calculations in the 
# irreducible Brillouin Zone can be done.
##################################################################################


ecut 30                  # Maximal kinetic energy cut-off, in Hartree. Note that this
                         # value should be determined from a convergence study. 
                         # is explained in the basic tutorials on the website of Abinit. 
nband 130                # This is the number of bands that are included. This should be large
                         # enough to include bands in the conduction band. 

autoparal 1         # Automatic paralelization. For ground-state calculations like this
                    # this variable should be set to 1. For bandstructure diagram calculations
                    # autoparal should be set to 0, as it will give errors otherwise.
ixc 11              # This defines the exchange-corrolation functiona. In this case it is 
                    # the GGA, Perdew-Burke-Ernzerhof GGA functional 

ngkpt 4 4 4              # This sets the k-point grid to a 4x4x4 grid. Note that this grid is very 
                         # small for studying carrier multiplications. The amount of k-points impact
                         # the runtime for the DFT calculations by Abinit, but also the calculations
                         # done by cmscript.py. For MoTe2 the densest grid that was calculated was 
                         # 16x16x8, but had not fully converged. 
kptopt  3                # Option for the automatic generation of k points. In this case we do
                         # do Full Brillouin Zone calculations and therefore set this variable to 3.
prtkpt 1                 # Prints k points as output. Not per se needed, but may be useful. 
nshiftk 1                # This variable states that the grid will be shifted. Unshifted grids
                         # gave me warnings in the output. It should not have a big impact on 
                         # the outcome of the calculations.
shiftk  0.0 0.0 1/2      

toldfe  1.0d-8     # This value is way too large for most realistic studies of materials
enunit  1          # Will output the eigenenergies in eV 


# Definition of the SCF procedure. These values are usually unchanged for different calculations.
# Make sure that the pp_dirpath and pseudos are defined properly
nstep 100                                  # Maximal number of SCF cycles
diemac 12.0                                # Although this is not mandatory, it is worth to
                                           # precondition the SCF cycle. The model dielectric
                                           # function used as the standard preconditioner
                                           # is described in the "dielng" input variable section.
                                           # Here, we follow the prescription for bulk silicon.
pp_dirpath "$ABI_PSPDIR"                   # This defines the path to the directory containing the
                                           # pseudopotentials
pseudos "/Mo.psp8, /Te.psp8"     # This defines the names of the pseudopotentials that
                                           # are to be used. Note that for spinorbit coupling
                                           # these should be


##################################################################################
# The following variables are set for MoTe2. Here the unit cell dimensions are defined,
# the type and positions in the unit cell of the atoms, etc.

# Definition of the atom types and attributes
ntypat 2          # This variable defines how many different elements there are in the unit cell.
                  # MoTe2 has two different elements: Mo and Te.
znucl 42 52       # The keyword "znucl" refers to the atomic number of the 
                  # possible type(s) of atom. The pseudopotential(s) 
                  # mentioned in the "files" file must correspond
                  # to the type(s) of atom. Here, 42 is Mo and 52 is Te
nspinor 2         # enable spinorbit calculations in Abinit. This is needed for heavy atoms
                  # Note that the use of this option requires
                  # pseudopotential files which have included spinorbit coupling in their calculations.
                  # These are the full-relativistic norm conserving pseudopotentials on PseudoDojo
so_psp 1 1        # force spinorbit calculations for both atoms

# Now the unit cell dimensions and the position of the atoms are defined. The atom positions have a big
# impact on the band structure. It is common that the atom positions are optimized, so that energy is minimized.
# It may however be easier to obtain the experimentally determined crystal structure from literature. 
# Crystal structures can also be found on https://materialsproject.org/ These do not always agree with
# experimentally determined crystal structures.
# Note that the units for distances in Abinit are in Bohr instead of Angstrom.

acell  6.649946233 6.649946233 26.38813513    # This is the length of each primitive lattice vector that will
                                              # be defined next in the

rprim  0.5 -0.8660254 0.0                     # Here the primitive lattice vectors are defined. Each vector will be 
       0.5  0.8660254 0.0                     # scaled with the acell variable. The primitive lattice vectors for 
       0.0  0.0       1.0                     # each Bravais lattice can be found in 10.1016/j.commatsci.2010.05.010
                                              # MoTe2 has an hexagonal lattice and therefore the primitive vectors
                                              # are defined as follows.

natom 6                          # Number of atoms in a unit cell. 
typat 1 1 2 2 2 2                # First two are Mo, the next four are Te. 
xred                             # This keyword indicate that the fractional coordinates of the atoms in the unit cell.
                                 # The order of typat is used, so the first two coordinates are for the Mo atoms
                                 # and the final four are for the Te atoms
   1/3 2/3 1/4                   # Triplet giving the REDUCED coordinate of Mo1.
   2/3 1/3 3/4                   # Triplet giving the REDUCED coordinate of Mo2.
   1/3 2/3 0.621000              # Te1
   2/3 1/3 0.379000              # Te2
   2/3 1/3 0.121000              # Te3
   1/3 2/3 0.879000              # Te4


